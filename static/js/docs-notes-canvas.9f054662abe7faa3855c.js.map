{"version":3,"sources":["webpack:///./docs/notes/canvas.md"],"names":["MDXContent","props","_this","_classCallCheck","this","_possibleConstructorReturn","_getPrototypeOf","call","layout","React","Component","_this$props","components","_objectWithoutProperties","react__WEBPACK_IMPORTED_MODULE_0___default","a","createElement","_mdx_js_tag__WEBPACK_IMPORTED_MODULE_1__","name","id","parentName","href","className"],"mappings":"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","file":"static/js/docs-notes-canvas.8caa7b6d.js","sourcesContent":["\n  import React from 'react'\n  import { MDXTag } from '@mdx-js/tag'\n  \n\nexport default class MDXContent extends React.Component {\n  constructor(props) {\n    super(props)\n    this.layout = null\n  }\n  render() {\n    const { components, ...props } = this.props\n\n    return <MDXTag\n             name=\"wrapper\"\n             \n             components={components}><MDXTag name=\"h1\" components={components} props={{\"id\":\"canvas\"}}>{`Canvas`}</MDXTag>\n<MDXTag name=\"h2\" components={components} props={{\"id\":\"canvas-is-not-origin-clean\"}}>{`canvas is not origin-clean`}</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`canvas`}</MDXTag>{` 加载了远程图片后调用 `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`captureStream`}</MDXTag>{` 出错，提示 `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`canvas is not origin-clean`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`具体原因：`}<MDXTag name=\"a\" components={components} parentName=\"p\" props={{\"href\":\"https://www.w3.org/TR/2011/WD-html5-20110405/the-canvas-element.html\"}}>{`https://www.w3.org/TR/2011/WD-html5-20110405/the-canvas-element.html`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`解决方法：\n1. 将图片数据获取到本地然后通过 `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`URL.createObjectURL`}</MDXTag>{`\n2. 设置 Image crossOrigin 属性`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"1-urlcreateobjecturl\"}}>{`1. URL.createObjectURL`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-js\"}}>{`const loadImg = (src) => {\n  return new Promise((resolve) => {\n    fetch(src).then((response) => {\n    const img = new Image();\n    img.onload = () => {\n      resolve(img);\n    };\n    img.src = URL.createObjectURL(response.blob());\n    window.setTimeout(() => {\n      resolve(null);\n    }, 30 * 1000);\n  }).catch(() => resolve(null)));\n};\n`}</MDXTag></MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"2-设置-image-crossorigin-属性\"}}>{`2. 设置 Image crossOrigin 属性`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-js\"}}>{`const loadImg = (blob) => {\n  return new Promise((resolve) => {\n    const img = new Image();\n    img.crossOrigin = 'anonymous';\n    img.onload = () => {\n      resolve(img);\n    };\n    img.src = src;\n    window.setTimeout(() => {\n      resolve(null);\n    }, 30 * 1000);\n  });\n};\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`参考资料：\n1. `}<MDXTag name=\"a\" components={components} parentName=\"p\" props={{\"href\":\"https://juejin.im/post/5aefc0456fb9a07abc29d36d\"}}>{`基于canvas生成图片`}</MDXTag>{`\n2. `}<MDXTag name=\"a\" components={components} parentName=\"p\" props={{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/HTML/CORS_enabled_image\"}}>{`MDN: 启用了 CORS 的图片`}</MDXTag></MDXTag>\n<MDXTag name=\"h2\" components={components} props={{\"id\":\"capturestream-自动播放\"}}>{`captureStream 自动播放`}</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`captureStream`}</MDXTag>{` 生成的 `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`stream`}</MDXTag>{` 无法自动播放。`}</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`captureStream`}</MDXTag>{` 接口调用时入参是最大帧率，`}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`canvas`}</MDXTag>{` 在变化的时候才会产生新的帧，所以一个静止的 `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`canvas`}</MDXTag>{` 只会产生一帧，导致 `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`stream`}</MDXTag>{` 无法自动播放。`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`启动一个定时器，刷新 `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`canvas`}</MDXTag>{` 的左上角可以解决这个问题。`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-js\"}}>{`const ctx = document.getElementById('canvas').getContext('2d');\n\nwindow.setInterval(()=>{\n  ctx.fillStyle = '#fff';\n  ctx.fillRect(0, 0, 1, 1);\n}, 100);\n`}</MDXTag></MDXTag>\n<MDXTag name=\"h2\" components={components} props={{\"id\":\"性能优化\"}}>{`性能优化`}</MDXTag>\n<MDXTag name=\"ol\" components={components}>\n<MDXTag name=\"li\" components={components} parentName=\"ol\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial/Optimizing_canvas\"}}>{`https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial/Optimizing_canvas`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ol\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"https://www.html5rocks.com/zh/tutorials/canvas/performance/#toc-clear-canvas\"}}>{`https://www.html5rocks.com/zh/tutorials/canvas/performance/#toc-clear-canvas`}</MDXTag></MDXTag>\n</MDXTag>\n           </MDXTag>\n  }\n}\n  "],"sourceRoot":""}